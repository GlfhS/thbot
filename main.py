import asyncio
from aiogram import Bot, Dispatcher, types
from aiogram.types import ReplyKeyboardMarkup, KeyboardButton
from aiogram.filters import Command
from config import BOT_TOKEN, ADMIN_ID

# ===== Flask-—Å–µ—Ä–≤–µ—Ä –¥–ª—è Replit =====
from flask import Flask
from threading import Thread

app = Flask('')

@app.route('/')
def home():
    return "–ë–æ—Ç –∂–∏–≤ üëã"

def run():
    app.run(host='0.0.0.0', port=8080)

def keep_alive():
    t = Thread(target=run)
    t.start()

# ====================================

bot = Bot(token=BOT_TOKEN)
dp = Dispatcher()

# –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
main_menu = ReplyKeyboardMarkup(
    keyboard=[
        [KeyboardButton(text="üìö –û –∫–∞—Ñ–µ–¥—Ä–µ")],
        [KeyboardButton(text="üéì –ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ")],
        [KeyboardButton(text="üìò –î–∏—Å—Ü–∏–ø–ª–∏–Ω—ã –ø–æ –∫—É—Ä—Å–∞–º")],
        [KeyboardButton(text="‚ùì –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã")],
        [KeyboardButton(text="üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã")],
    ],
    resize_keyboard=True
)

courses_menu = ReplyKeyboardMarkup(
    keyboard=[
        [KeyboardButton(text="1Ô∏è‚É£ –ü–µ—Ä–≤—ã–π –∫—É—Ä—Å"), KeyboardButton(text="2Ô∏è‚É£ –í—Ç–æ—Ä–æ–π –∫—É—Ä—Å")],
        [KeyboardButton(text="3Ô∏è‚É£ –¢—Ä–µ—Ç–∏–π –∫—É—Ä—Å"), KeyboardButton(text="4Ô∏è‚É£ –ß–µ—Ç–≤—ë—Ä—Ç—ã–π –∫—É—Ä—Å")],
        [KeyboardButton(text="‚¨ÖÔ∏è –ù–∞–∑–∞–¥")],
    ],
    resize_keyboard=True
)

# –ö–æ–º–∞–Ω–¥—ã –∏ –∫–Ω–æ–ø–∫–∏
@dp.message(Command("start"))
async def cmd_start(message: types.Message):
    await message.answer(
        "üëã –ü—Ä–∏–≤–µ—Ç! –Ø ‚Äî –±–æ—Ç –∫–∞—Ñ–µ–¥—Ä—ã. –í–æ—Ç —á—Ç–æ —è —É–º–µ—é:",
        reply_markup=main_menu
    )

@dp.message(lambda msg: msg.text == "üìö –û –∫–∞—Ñ–µ–¥—Ä–µ")
async def about_department(message: types.Message):
    await message.answer(
        "üìö *–ö–∞—Ñ–µ–¥—Ä–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π*\n\n"
        "üõ† –ü—Ä–æ—Ñ–∏–ª—å: *–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –≤ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–µ*\n"
        "üë®‚Äçüíª –û–±—É—á–µ–Ω–∏–µ –≤–∫–ª—é—á–∞–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É, –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ –∏ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏–µ –ò–¢-—Ä–µ—à–µ–Ω–∏–π –≤ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–µ\n"
        "üìà –í—ã–ø—É—Å–∫–Ω–∏–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –≤ IT-–∫–æ–º–ø–∞–Ω–∏—è—Ö, –∏–Ω–∂–∏–Ω–∏—Ä–∏–Ω–≥–µ, –æ—Ä–≥–∞–Ω–∞—Ö –≤–ª–∞—Å—Ç–∏ –∏ –ø—Ä–æ–µ–∫—Ç–Ω—ã—Ö –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è—Ö\n"
        "üéØ –í–∏–¥—ã –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏: –ø—Ä–æ–µ–∫—Ç–Ω–∞—è, –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ-—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è, –Ω–∞—É—á–Ω–∞—è\n\n"
        "üìç –ê–¥—Ä–µ—Å: –≥. –ú–∞–∫–µ–µ–≤–∫–∞, —É–ª. –î–µ—Ä–∂–∞–≤–∏–Ω–∞, 2, –∞—É–¥. 1.563\n"
        "üìû –¢–µ–ª.: +7 (949) 370-63-25\n"
        "üìß ist@donnasa.ru\n"
        "üîó –ü–æ–¥—Ä–æ–±–Ω–µ–µ: https://donnasa.ru/?page_id=100947&lang=ru"
    )

@dp.message(lambda msg: msg.text == "üéì –ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ")
async def admission_info(message: types.Message):
    await message.answer(
        "üéì *–ö–∞–∫ –ø–æ—Å—Ç—É–ø–∏—Ç—å:*\n"
        "‚Ä¢ –î–æ–∫—É–º–µ–Ω—Ç –æ —Å—Ä–µ–¥–Ω–µ–º –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏\n"
        "‚Ä¢ –í—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–µ —ç–∫–∑–∞–º–µ–Ω—ã / –ï–ì–≠\n"
        "‚Ä¢ –ó–∞—á–∏—Å–ª–µ–Ω–∏–µ ‚Äî –Ω–∞ –±—é–¥–∂–µ—Ç –∏–ª–∏ –∫–æ–Ω—Ç—Ä–∞–∫—Ç\n\n"
        "üìå –° 2025 –≥–æ–¥–∞ –î–æ–Ω–ù–ê–°–ê —Å—Ç–∞–ª —Ñ–∏–ª–∏–∞–ª–æ–º –ù–ò–£ –ú–ì–°–£\n"
        "üî¨ –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏: —Å—Ç–∞–∂–∏—Ä–æ–≤–∫–∏, –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è, —É—Å–∏–ª–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞\n"
        "üìù –°–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Ñ–æ—Ä–º—ã –∏ —É—Å–ª–æ–≤–∏—è –æ–±—É—á–µ–Ω–∏—è, –≤—Å–µ –ø—Ä–∞–≤–∞ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∑–∞—â–∏—â–µ–Ω—ã\n\n"
        "üìÖ –ü—Ä–∏—ë–º–Ω–∞—è –∫–æ–º–∏—Å—Å–∏—è:\n"
        "–ü–Ω‚Äì–ü—Ç: 09:00‚Äì15:00, –°–±: 09:00‚Äì14:00\n"
        "üìß vstup@donnasa.ru\n"
        "üåê –ü–æ–¥—Ä–æ–±–Ω–µ–µ: https://donnasa.ru/?page_id=111446&lang=ru"
    )

@dp.message(lambda msg: msg.text == "üìò –î–∏—Å—Ü–∏–ø–ª–∏–Ω—ã –ø–æ –∫—É—Ä—Å–∞–º")
async def show_course_menu(message: types.Message):
    await message.answer("–í—ã–±–µ—Ä–∏—Ç–µ –∫—É—Ä—Å:", reply_markup=courses_menu)

@dp.message(lambda msg: msg.text == "1Ô∏è‚É£ –ü–µ—Ä–≤—ã–π –∫—É—Ä—Å")
async def first_course(message: types.Message):
    await message.answer(
        "üìò *1 –∫—É—Ä—Å:*\n"
        "‚Ä¢ –ò—Å—Ç–æ—Ä–∏—è, –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞, —Ñ–∏–∑–∏–∫–∞, –∞–Ω–≥–ª–∏–π—Å–∫–∏–π\n"
        "‚Ä¢ –ò–Ω–∂–µ–Ω–µ—Ä–Ω–∞—è –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–∞—è –≥—Ä–∞—Ñ–∏–∫–∞\n"
        "‚Ä¢ –ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ, –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞\n"
        "‚Ä¢ –û–∑–Ω–∞–∫–æ–º–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞"
    )

@dp.message(lambda msg: msg.text == "2Ô∏è‚É£ –í—Ç–æ—Ä–æ–π –∫—É—Ä—Å")
async def second_course(message: types.Message):
    await message.answer(
        "üìò *2 –∫—É—Ä—Å:*\n"
        "‚Ä¢ –§–∏–ª–æ—Å–æ—Ñ–∏—è, –ø—Ä–∞–≤–æ, —ç–∫–æ–Ω–æ–º–∏–∫–∞\n"
        "‚Ä¢ –û–û–ü, –±–æ–ª—å—à–∏–µ –¥–∞–Ω–Ω—ã–µ, –ò–ò\n"
        "‚Ä¢ –î–∏—Ñ—Ñ. —É—Ä–∞–≤–Ω–µ–Ω–∏—è, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞\n"
        "‚Ä¢ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞"
    )

@dp.message(lambda msg: msg.text == "3Ô∏è‚É£ –¢—Ä–µ—Ç–∏–π –∫—É—Ä—Å")
async def third_course(message: types.Message):
    await message.answer(
        "üìò *3 –∫—É—Ä—Å:*\n"
        "‚Ä¢ –ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –û–°, BIM\n"
        "‚Ä¢ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è\n"
        "‚Ä¢ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, –ª–æ–≥–∏—Å—Ç–∏–∫–∞, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ\n"
        "‚Ä¢ –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–æ–Ω–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞"
    )

@dp.message(lambda msg: msg.text == "4Ô∏è‚É£ –ß–µ—Ç–≤—ë—Ä—Ç—ã–π –∫—É—Ä—Å")
async def fourth_course(message: types.Message):
    await message.answer(
        "üìò *4 –∫—É—Ä—Å:*\n"
        "‚Ä¢ –°–∏—Å—Ç–µ–º–Ω–æ–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ\n"
        "‚Ä¢ Web, GIS, –∑–∞—â–∏—Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏\n"
        "‚Ä¢ –ê–°–£, –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ\n"
        "‚Ä¢ –ü—Ä–µ–¥–¥–∏–ø–ª–æ–º–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞, –í–ö–†"
    )

@dp.message(lambda msg: msg.text == "‚¨ÖÔ∏è –ù–∞–∑–∞–¥")
async def back_to_main(message: types.Message):
    await message.answer("–í—ã –≤–µ—Ä–Ω—É–ª–∏—Å—å –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é:", reply_markup=main_menu)

@dp.message(lambda msg: msg.text == "‚ùì –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã")
async def faq(message: types.Message):
    await message.answer(
        "‚ùì *–ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã:*\n"
        "‚Äî –ï—Å—Ç—å –ª–∏ –æ–±—â–µ–∂–∏—Ç–∏–µ? ‚úÖ –î–∞\n"
        "‚Äî –ö–∞–∫–∏–µ —ç–∫–∑–∞–º–µ–Ω—ã? üìò –†—É—Å—Å–∫–∏–π, –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞, –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞/–∞–Ω–≥–ª–∏–π—Å–∫–∏–π\n"
        "‚Äî –í–æ–µ–Ω–Ω–∞—è –∫–∞—Ñ–µ–¥—Ä–∞? ‚ùå –ü–æ–∫–∞ –Ω–µ—Ç\n"
        "‚Äî –ö–æ–Ω—Ç—Ä–∞–∫—Ç/–±—é–¥–∂–µ—Ç? ‚úÖ –ï—Å—Ç—å –æ–±–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞"
    )

@dp.message(lambda msg: msg.text == "üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã")
async def contacts(message: types.Message):
    await message.answer(
        "üìç *–ê–¥—Ä–µ—Å:*\n"
        "286123, –≥. –ú–∞–∫–µ–µ–≤–∫–∞, —É–ª. –î–µ—Ä–∂–∞–≤–∏–Ω–∞, –¥. 2\n"
        "–§–ì–ë–û–£ –í–û ¬´–î–æ–Ω–ù–ê–°–ê¬ª ‚Äî —Ñ–∏–ª–∏–∞–ª –ù–ò–£ –ú–ì–°–£\n"
        "1-–π —É—á–µ–±–Ω—ã–π –∫–æ—Ä–ø—É—Å, –∞—É–¥. 1-563\n\n"
        "‚úâÔ∏è ist@donnasa.ru\n"
        "üìû +7 (949) 370-63-25\n"
        "üïê –ü–Ω‚Äì–ü—Ç: 09:00‚Äì15:00"
    )

@dp.message()
async def fallback(message: types.Message):
    await message.answer("üëã –ù–∞–∂–º–∏—Ç–µ /start –¥–ª—è –Ω–∞—á–∞–ª–∞ –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ –ø—É–Ω–∫—Ç –∏–∑ –º–µ–Ω—é.")

# === –ó–∞–ø—É—Å–∫ ===
async def main():
    await dp.start_polling(bot)

if __name__ == "__main__":
    keep_alive()
    asyncio.run(main())
